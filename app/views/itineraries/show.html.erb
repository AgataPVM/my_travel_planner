<div class="container my-4">
  <div class="card shadow-sm border-dark rounded-4 mb-3">
    <div class="card-body p-4">
      <h1 class="card-title mb-4 text-primary fw-bold"><%= @itinerary.title %></h1>

      <p class="mb-2"><strong>Destino:</strong> <%= @itinerary.destination %></p>
      <p class="mb-2"><strong>Número de pessoas:</strong> <%= @itinerary.people %></p>
      <p class="mb-2"><strong>Número de dias:</strong> <%= @itinerary.days %></p>
      <p class="mb-2"><strong>Interesses:</strong> <%= @itinerary.interest %></p>
    </div>
  </div>

  <div id="itinerary_content" class="card shadow-sm border-dark rounded-4 mb-4">
    <div class="card-body p-4">
      <h2 class="card-title mb-4 text-primary fw-bold">Itinerário:</h2>

      <div class="generated-content fs-6 text-dark lh-base">
        <%= raw(render_markdown(@itinerary.content)) %>
      </div>

      <div class="mt-3 d-flex gap-2">
        <%= link_to "Remover", itinerary_path(@itinerary),
            data: { turbo_method: :delete, turbo_confirm: "Tem certeza?" },
            class: "btn btn-danger" %>
        <%= link_to "Voltar", itineraries_path, class: "btn btn-primary" %>
      </div>
    </div>
  </div>

  <div class="mb-3">
    <h3 class="h5 mb-3">Mensagens</h3>
    <div id="messages" class="d-flex flex-column gap-2">
      <% @itinerary.messages.each do |message| %>
        <% if message.role == "user" %>
          <div class="d-flex justify-content-end">
            <div class="bg-white px-3 py-2 rounded-pill shadow-sm">
              <%= raw(render_markdown(message.content)) %>
            </div>
          </div>
        <% else %>
          <div class="d-flex justify-content-start">
            <div class="px-3 py-2 rounded-3">
              <%= raw(render_markdown(message.content)) %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <div id="new_message">
    <%= simple_form_for [@itinerary, @message],
          html: { data: { turbo_preserve_scroll: true } } do |f| %>
      <%= f.input :content, label: false,
            input_html: { rows: 3, placeholder: "Peça ajustes no roteiro ou faça uma pergunta..." } %>
      <%= f.button :submit, "Enviar", class: "btn btn-primary" %>
    <% end %>
  </div>
</div>
